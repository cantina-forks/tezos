<html lang="en">

<head>
    <meta charset="utf-8">
    <title>Adress Endorsement reception delays</title>
    <script src=https://cdnjs.cloudflare.com/ajax/libs/mathjs/3.3.0/math.min.js></script>
    <script src="https://cdn.jsdelivr.net/npm/d3@7.4.4/dist/d3.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3-legend/2.13.0/d3-legend.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.27.2/axios.min.js"
        integrity="sha512-odNmoc1XJy5x1TMVMdC7EMs3IVdItLPlCeL5vSUPN2llYKMJ2eByTTAIiiuqLg+GdNr9hF6z81p27DArRFKT7A=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>

</head>

<body>
    <script type="text/javascript" src="./js/populate_sort_data.js"></script>

    <h1> Adress Endorsement reception delays </h1>
    <form>
        <div>
            <label for="selectedLevel_begin">First bloc:</label>
            <input name="level_" id="selectedLevel_begin" type="number" value="179000" />
            <span id='tick_begin'></span>
            <br>
            <label for="selectedLevel_end">Last bloc:</label>
            <input name="level_" id="selectedLevel_end" type="number" value="179020" />
            <span id='tick_end'></span>
            <br>
            <label for="adress_">delegate adress:</label>
            <input name="adress_" id="adress_" type="string" value="tz3WXYtyDUNL91qfiCJtVUX746QpNv5i5ve5" />
            <input type="button" id="submit_" value="Search ">

        </div>
    </form>
    <script>
        var dict_data = {};
        const server_adress = "http://kathmandunet.kaml.fr:8880/";
        
        function main() {
            try {
                $('#submit_').mouseup(async function (e) {
                    beg_ = document.getElementById('selectedLevel_begin').value;
                    end_ = document.getElementById('selectedLevel_end').value;
                    adresse = document.getElementById('adress_').value;

                    let dict_data = populate_v1(server_adress, beg_, end_).then(dict_data => {
                        let t_valide=delegate_delays_distribution_of_operations(dict_data, adresse,true);
                        console.log(t_valide);
                        let ope_observation = classify_operations(dict_data, adresse,true);
                        console.log("ope_observation",ope_observation);
                        let result = get_info_bloc(dict_data,true);
                        let t_baker=result[1]
                        chart_consensus_operation_specific_address(t_valide);
                        chart_time_mean_deviation(t_valide);
                        resume_obs(ope_observation,t_baker, adresse);
                    })

                });


            } catch (e) {
                console.log(e)
            }
        }
        main()


    </script>
    <div id="dataviz"></div>
    <div id="ecart_moyenne"></div>
    <div id="resume"></div>